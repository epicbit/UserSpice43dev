Database Changes
mqtt Table - Add entire table

settings Table add msg_notification, permission_restriction, auto_assign_un int 1 def 0
ALTER TABLE `settings` ADD `page_permission_restriction` INT(1) NOT NULL DEFAULT '0' AFTER `auto_assign_un`;

ALTER TABLE `settings` ADD `msg_blocked_users` INT(1) NOT NULL DEFAULT '0' AFTER `page_permission_restriction`;


pages Table - Add column re_auth int 1 default 0

users Table - Add column msg_exempt int 1 default 0
              Add column last_confirm datetime default NULL
              ADD `protected` INT(1) NOT NULL DEFAULT
              ADD `dev_user` INT(1) NOT NULL DEFAULT '0'
              ADD `msg_notification` INT(1) NOT NULL DEFAULT '1'
              ADD `force_pr` INT(1) NOT NULL DEFAULT '0'

message_threads Table - Add  archive_from, archive_to, hidden_from, hidden_to  int 1 default 0
add crons and crons_logs tables

-- Table structure for table `logs`

CREATE TABLE `logs` (
  `id` int(11) NOT NULL,
  `user_id` int(3) NOT NULL,
  `logdate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `logtype` varchar(25) NOT NULL,
  `lognote` text NOT NULL,
  `added` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

-- Indexes for table `logs`
ALTER TABLE `logs`
  ADD PRIMARY KEY (`id`);

-- AUTO_INCREMENT for table `logs`
ALTER TABLE `logs`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

  -- Table structure for table `logs_exempt`
CREATE TABLE `logs_exempt` (
  `id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `createdby` int(11) NOT NULL,
  `created` datetime DEFAULT CURRENT_TIMESTAMP,
  `modified` datetime DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

-- Indexes for table `logs_exempt`
ALTER TABLE `logs_exempt`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `logs_exempt_type` (`name`);

-- AUTO_INCREMENT for table `logs_exempt`
ALTER TABLE `logs_exempt`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

SET ALL NEW PAGE PERMISSIONS PROPERLY


OTHER NOTES
1- Make sure the init and chunks are up to date with class autoloading.

2- Test and offer init patch.
https://gist.github.com/Firestorm-Graphics/98f80b2b45c591d107c35c5f7e5c8632#file-patch_init-php

3- Test mail features after autoload

4- MQTT is currently Publish Only.  PHP isn't great for subbing.

5- Add
  mqtt_settings.php
  adminverify.php
as admin for upgraders

6- OCE Bug - Response message is getting refreshed away.

7- Messaging system needs to be tested.

8- Unable to update reauth checkbox from admin_page.php

9- Google may require you to generate new recaptcha keys.
